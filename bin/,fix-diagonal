#!/home/brandon/.v/skyfield/bin/python3
#
# Fix an Instagram image that they have skewed into a diagonal image.

import sys
from PIL import Image

if len(sys.argv) != 2:
    print('usage: ,fix-diagonal instagram-image.jpeg')
    exit(2)

path = sys.argv[1]
with Image.open(path) as im:
    data = im.getdata()
    rgb_tuples = list(data)
    print(im.size)
    x, y = im.size
    x -= 1
    out_size = x, y
    print(out_size)
    out = Image.new(im.mode, out_size)
    out.putdata(rgb_tuples[:x*y])
    out.save('fixed.png')
